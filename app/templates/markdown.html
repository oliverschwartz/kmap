<!DOCTYPE html>
<html>
<head>
    <title>Study Graph</title  <!-- SG icon -->
    <link rel="icon" href="img/graph-favicon.png" type="image/x-icon">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Google Fonts Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <!-- Material Design Bootstrap -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mdb.min.css') }}">
    <!-- Your custom styles (optional) -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- For markdown editor -->
    <link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
    <script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
</head>
<body>

    <textarea></textarea>
    <script>
        
        // Get the URL parameters (graph id and node id)
        const urlParams = new URLSearchParams(window.location.search);
        const graphID = urlParams.get("graph_id"); 
        const nodeID = urlParams.get("node_id"); 
        const saveURL = "/node-save?" + "graph_id=" + graphID + "&node_id=" + nodeID;


        // Create the markdown editor. 
        height = (window.innerHeight - 200).toString() + "px";
        var easyMDE = new EasyMDE({maxHeight: height});
       
        // Load the stuff from the database. 
        $.post('/node-load', {'graph_id': graphID, 'node_id': nodeID}, 
            function(data, status) {
                easyMDE.value(data); 
            }
        );

        // On 'save', make a POST to the backend to save this content. 
        save = function() {
            $.post(saveURL, 
            {"markdown_text": easyMDE.value()}, 
            function() {
                console.log("save(): success"); 
            }); 
        }
    </script>

    <div class="container">
        <button class="btn btn-primary" style="height: 50px;" onclick="save();">Save</button>
    </div>

</body>

<!-- jQuery -->
</html> 